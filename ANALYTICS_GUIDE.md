# 问渠 - 数据埋点方案设计

> 📊 **AI产品实习生作品** | 从0到1设计完整的数据指标体系
> 
> **项目状态**: ✅ 方案设计完成 | 🚧 本地演示环境

---

## 一、设计背景与目标

### 为什么重视数据？

作为AI产品实习生，我深刻认识到：**数据思维不等于大数据，而是要用数据思考问题的方法。**

即使项目处于早期阶段，我也希望建立完整的数据方法论，为后续产品迭代打下基础。

### 设计目标

1. **量化产品表现**: 用数据衡量AI回答质量、用户满意度
2. **发现优化机会**: 通过漏斗分析找到关键流失节点
3. **验证产品假设**: 建立A/B测试框架，用实验驱动优化
4. **积累数据资产**: 为后续的模型训练和算法优化积累数据

---

## 二、指标体系设计

### 2.1 北极星指标

**对话完成率 = 完成对话用户数 / 开始对话用户数**

**选择理由**: 只有用户完成对话，才真正获得价值。完成率低说明产品体验或AI质量存在问题。

**目标值**: > 85%

### 2.2 分层指标体系

```
                    北极星指标
                   对话完成率
                        │
        ┌───────────────┼───────────────┐
        │               │               │
    用户活跃度      产品性能        用户满意度
        │               │               │
   ┌────┴────┐     ┌────┴────┐     ┌────┴────┐
   │         │     │         │     │         │
  DAU/MAU  留存率  响应时间  错误率   CSAT     NPS
```

| 层级 | 指标 | 说明 | 目标值 |
|------|------|------|--------|
| L1 | 对话完成率 | 核心目标指标 | > 85% |
| L2 | DAU/MAU | 日活/月活用户 | 持续追踪 |
| L2 | 7日留存率 | 用户粘性 | > 30% |
| L3 | 功能使用率 | 各功能使用分布 | - |
| L3 | 平均响应时间 | AI生成速度 | < 3s |
| L4 | CSAT | 用户满意度评分 | > 4.0/5 |
| L4 | NPS | 净推荐值 | > 30 |

---

## 三、埋点方案设计

### 3.1 埋点设计原则

1. **用户旅程全覆盖**: 追踪从进入到离开的完整路径
2. **关键行为必埋**: 转化节点、异常场景必须埋点
3. **属性丰富**: 记录上下文信息，便于多维分析
4. **不重不漏**: 避免重复埋点，也不遗漏关键事件

### 3.2 用户旅程埋点

```
用户旅程:  进入首页 → 选择功能 → 填写信息 → 提交请求 → 等待生成 → 查看结果 → 分享/退出
            │          │          │          │          │          │         │
事件名称:  page_view   nav_click  form_focus ai_request ai_start   ai_view   share
            │          │          │          │          │          │         │
关键属性:   source     feature    input_type question   wait_time  duration  channel
            referrer   name       fields     type       response   length    
                                                     │      time
                                                     └── error (失败时)
```

### 3.3 核心事件定义

| 事件名 | 触发时机 | 关键属性 | 分析价值 |
|--------|----------|----------|----------|
| `page_view` | 页面加载完成 | page_name, source, referrer | 流量来源分析 |
| `feature_click` | 点击功能入口 | feature_name | 功能偏好分析 |
| `form_submit` | 提交咨询表单 | feature, question_type | 需求分布分析 |
| `ai_request` | 发送AI请求 | feature, params | 调用量统计 |
| `ai_response` | 收到AI回复 | duration, success | 性能监控 |
| `ai_view` | 查看完整回答 | scroll_depth, time_spent | 内容质量评估 |
| `share` | 分享结果 | channel | 传播效果分析 |
| `error` | 发生错误 | error_type, message | 问题定位 |

### 3.4 转化漏斗设计

**主漏斗：咨询转化漏斗**

```
步骤1: 进入功能页  →  步骤2: 填写表单  →  步骤3: 提交请求  →  步骤4: 查看结果
   100%                70%                 50%                 40%
                        │                   │                   │
                     流失30%             流失20%             流失10%
                        │                   │                   │
                   原因分析:           原因分析:           原因分析:
                   - 功能不吸引       - 表单太复杂       - 等待太久
                   - 用户没搞懂       - 担心隐私         - 结果不满意
```

---

## 四、数据驱动优化案例

### 案例1: 优化AI等待体验

**发现问题**
- 通过漏斗分析发现：提交请求后，40%用户没有等到结果就离开
- 访谈验证：用户不知道AI正在生成，以为页面卡住了

**提出假设**
- 假设：增加进度提示可以降低等待焦虑，减少流失

**设计指标**
- 核心指标：等待阶段流失率
- 辅助指标：平均等待时长、用户满意度

**设定成功标准**
- 等待流失率从40%降至30%以下算成功

**设计方案**
- 增加加载动画
- 添加文字提示"AI正在思考，请稍候..."
- 进度条展示生成进度

**预期效果**
- 等待流失率：40% → 30%
- 用户满意度：+15%

> **注**: 以上为方案设计，因项目未上线，实际效果待验证。

### 案例2: Prompt优化A/B测试

**测试目标**: 验证增加"思维链"是否能提升AI回答质量

**分组设计**:
- **对照组(A)**: 原v1提示词
- **实验组(B)**: v2提示词（增加思维链引导）

**评价指标**:
- 主观指标：回答相关性评分（1-5分）
- 客观指标：用户追问率（追问率越低说明回答越完整）

**样本量**: 各50组对话

**预期结果**:
```
对照组(A): v1提示词 → 追问率 35%
实验组(B): v2提示词 → 追问率 18%

结论: v2提示词显著优于v1
```

---

## 五、技术实现方案

### 5.1 实现架构

```
前端埋点SDK
    │
    ├── 自动收集: 页面访问、点击事件、滚动深度
    │
    └── 手动埋点: 业务事件（form_submit、ai_request等）
              │
              ▼
        后端埋点API
              │
              ├── 数据校验
              ├── 敏感信息过滤
              └── 批量写入数据库
                        │
                        ▼
                  Supabase数据库
                        │
                  ┌─────┴─────┐
                  │           │
            统计分析      可视化看板
```

### 5.2 数据表设计

| 表名 | 用途 | 核心字段 |
|------|------|----------|
| `user_events` | 用户行为事件 | event_type, event_name, properties |
| `page_views` | 页面访问记录 | page_path, referrer, duration |
| `api_logs` | API调用日志 | endpoint, status, response_time |
| `user_sessions` | 用户会话统计 | session_id, start_time, end_time |
| `feature_usage` | 功能使用统计 | feature_type, action, params |
| `conversion_funnel` | 转化漏斗数据 | funnel_name, step_name, step_order |

### 5.3 统计视图

预置常用统计查询视图：
- `stats_daily_active_users` - 每日活跃用户数
- `stats_daily_feature_usage` - 每日功能使用统计
- `stats_api_performance` - API性能统计
- `stats_page_views` - 页面访问统计
- `stats_user_retention` - 用户留存率

---

## 六、数据看板设计

### 6.1 看板模块

**模块1: 核心指标概览**
- 今日DAU、对话完成率、平均响应时间
- 与昨日/上周对比

**模块2: 功能使用情况**
- 各功能使用次数分布
- 功能使用趋势图

**模块3: 用户转化漏斗**
- 咨询转化漏斗可视化
- 各步骤转化率

**模块4: API性能监控**
- 平均响应时间趋势
- 错误率趋势
- 慢接口TOP10

**模块5: 用户反馈汇总**
- 满意度评分分布
- 最近的用户评价

### 6.2 看板截图

（数据看板界面截图待补充）

---

## 七、数据隐私与安全

### 7.1 隐私保护措施

1. **敏感字段过滤**: API日志自动隐藏 password、token 等字段
2. **数据脱敏**: 用户ID进行哈希处理，不存储明文
3. **最小化收集**: 只收集产品分析必需的数据
4. **访问控制**: 用户只能查看自己的数据，管理员可查看全部

### 7.2 合规考虑

- 遵守《个人信息保护法》
- 用户授权后才收集行为数据
- 提供数据删除功能

---

## 八、写在最后

### 数据思维总结

通过这个数据方案的设计，我建立了以下数据思维：

1. **用数据定义问题**: 不是"用户不喜欢"，而是"完成率只有60%"
2. **用数据验证假设**: 不是"我觉得这个方案好"，而是"A/B测试证明B组更好"
3. **用数据衡量效果**: 不是"优化后体验变好了"，而是"流失率从15%降到8%"
4. **用数据指导决策**: 不是"我觉得该做这个功能"，而是"数据显示这个功能使用率最高"

### 局限性说明

由于本项目是**本地演示环境**，未能获得真实用户数据。上述案例中的数字均为设计阶段的预估数据，用于展示数据思维方法论。

在实际工作中，我会：
- 持续追踪真实数据，修正假设
- 定期进行数据复盘，发现新的优化机会
- 建立自动化的数据监控和报警机制

---

**相关文档**

- [完整埋点技术文档](./ANALYTICS_GUIDE_TECH.md)（如需查看技术实现细节）
- [A/B测试方案](./docs/analytics/AB_TEST_PLAN.md)
- [产品需求文档](./docs/product/PRD.md)

---

*这个数据方案展示了我作为AI产品实习生的数据思维能力，期待与您交流！*
